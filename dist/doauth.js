var DoAuthJs;(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{main:()=>o,observePeriodMsec:()=>r,observeMany:()=>i});const o=async()=>(window.sodium={onload:e=>{maybePort=()=>window.location.port?":"+window.location.port:"",window.doAuth={server:window.location.protocol+"//"+window.location.hostname+maybePort(),saltSize:16,hashSize:32,keySize:32,defaultParams:{opsLimit:e.crypto_pwhash_OPSLIMIT_SENSITIVE,memLimit:5*e.crypto_pwhash_MEMLIMIT_MIN}},window.doAuth.crypto={},window.doAuth.crypto.show=t=>e.to_base64(t,e.base64_variants.URLSAFE),window.doAuth.crypto.read=t=>e.from_base64(t,e.base64_variants.URLSAFE),window.doAuth.crypto.mainKey=e=>(slipMaybe=localStorage.getItem("slip"),dp=doAuth.defaultParams,slipMaybe?doAuth.crypto.mainKeyReproduce2(e,JSON.parse(slipMaybe)):([mkey,slip]=doAuth.crypto.mainKeyInit2(e,{ops:dp.opsLimit,mem:dp.memLimit,saltSize:doAuth.saltSize}),localStorage.setItem("slip",JSON.stringify(slip)),mkey)),window.doAuth.crypto.mainKeyInit2=(t,o)=>(slip1={...o,salt:doAuth.crypto.show(e.randombytes_buf(o.saltSize))},mkey=doAuth.crypto.mainKeyReproduce2(t,slip1),[mkey,slip1]),window.doAuth.crypto.mainKeyReproduce2=(t,o)=>{let{ops:r,mem:i,saltSize:d,salt:a}=o;return mkey=e.crypto_pwhash(doAuth.hashSize,t,doAuth.crypto.read(a),r,i,e.crypto_pwhash_ALG_DEFAULT),mkey},window.doAuth.crypto.deriveSigningKeypair=(t,o)=>{mkd=e.crypto_kdf_derive_from_key(doAuth.keySize,o,"signsign",t);let{publicKey:r,privateKey:i}=e.crypto_sign_seed_keypair(mkd);return{public:r,secret:i}},window.doAuth.crypto.sign=(t,o)=>({public:o.public,signature:e.crypto_sign_detached(t,o.secret)}),window.doAuth.crypto.verify=(t,o)=>e.crypto_sign_verify_detached(o.signature,t,o.public),window.doAuth.crypto.bland_hash=t=>doAuth.crypto.show(e.crypto_generichash(doAuth.hashSize,t)),window.doAuth.crypto.canonicalise=function e(t){if("string"==typeof t||"number"==typeof t||"bigint"==typeof t)return t;if("object"==typeof t){if(!0===Array.isArray(t))return t.map((t=>e(t)));{var o=Object.keys(t);const i={...t};o.sort();var r=new Array;for(let t=0;t<o.length;t++)r.push([o[t],e(i[o[t]])]);return r}}},window.doAuth.credential={},window.doAuth.credential.proofless=e=>{ctxs=e["@context"];let{type:t,issuer:o,issuanceDate:r,credentialSubject:i}=e;return{"@context":ctxs,type:t,issuer:o,issuanceDate:r,credentialSubject:i}},window.doAuth.credential.prooflessJSON=e=>JSON.stringify(doAuth.crypto.canonicalise(doAuth.credential.proofless(e))),window.doAuth.credential.verify=(e,t)=>doAuth.crypto.verify(doAuth.credential.prooflessJSON(e),{public:t,signature:doAuth.crypto.read(e.proof.signature)}),window.doAuth.credential.verify64=(e,t)=>doAuth.credential.verify(e,doAuth.crypto.read(t)),window.__doAuthHasLoaded__=!0}},new Promise(i((()=>[window.__doAuthHasLoaded__])))),r=30,i=(e,t)=>(o,d)=>e().reduce(((e,t)=>e&&t),!1)?o(maybeVars):t&&t>0?d(new Error("Observer timed out")):void setTimeout(i.bind(void 0,e,o,d,timeLeft-r),r);DoAuthJs=t})();